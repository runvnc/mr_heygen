{% block content %}
  <div class="main" id="mainContainer">
    <!-- <div id="debug-overlay2">DEBUG READY</div> -->

    <main class="container">
      <!-- Video Section -->
      <article>
        <div id="loading" class="loading"><div class="loading-spinner"></div></div>
        <video id="animation" src="/imgs/heygenloading.mp4"
               style="display: none;" 
               onerror="this.style.display='none'" 
               muted autoplay playsinline loop></video>
        <video id="avatarVideo" autoplay playsinline></video>
      </article>

      <!-- Controls Section -->
      <section class="load-section">
        <button id="startSession" class="session-toggle">Load Avatar</button>
      </section>
    </main>
    
    <chat-ai id="chatAi" sessionid="{{ log_id }}" agent_name="{{ agent_name }}" style="margin-top: 0;"></chat-ai>
  </div>

  <script src="/mr_heygen/static/bundle.js"></script>
  <script>
        
    // Function to check if device is mobile
    function isMobile() {
      console.log("Window width: " + window.innerWidth);
      return window.innerWidth <= 768;
    }

    // Function to update chat-log visibility based on screen size
    function updateChatLogVisibility() {
      const chatAi = document.getElementById('chatAi');
      if (chatAi) {
        const mainContainer = document.getElementById('mainContainer');
        // always hide chat log and use mobile layout    
        if (true || isMobile()) {
          console.log("Hiding chat log")
          chatAi.setAttribute('hide-chat-log', '');
          // Reset to column layout for mobile
          if (mainContainer) {
            mainContainer.style.flexDirection = 'column';
          }
        } else {
          console.log("Showing chat log")
          chatAi.removeAttribute('hide-chat-log');
          // Set row layout for desktop
          if (mainContainer) {
            mainContainer.style.flexDirection = 'row';
          }
        }
      }
    }
    
    // Initial check
    document.addEventListener('DOMContentLoaded', updateChatLogVisibility);
    
    // Update on window resize
    window.addEventListener('resize', updateChatLogVisibility);
  </script>
{% endblock %}
